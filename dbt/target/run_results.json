{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2025-10-26T20:46:34.961014Z", "invocation_id": "2a301818-3273-46d8-8f36-ff951044455e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T20:46:25.156698Z", "completed_at": "2025-10-26T20:46:25.164175Z"}, {"name": "execute", "started_at": "2025-10-26T20:46:25.165416Z", "completed_at": "2025-10-26T20:46:25.313139Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.16068577766418457, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.global_market_dbt.stg_global_index", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        CAST(`date` AS DATE) AS trade_date,\n        TRIM(`index_code`) AS index_name,\n        CAST(`open` AS DECIMAL(15,2)) AS open_price,\n        CAST(`high` AS DECIMAL(15,2)) AS high_price,\n        CAST(`low` AS DECIMAL(15,2)) AS low_price,\n        CAST(`close` AS DECIMAL(15,2)) AS close_price,\n        CAST(`adj_close` AS DECIMAL(15,2)) AS adj_close_price,\n        CAST(`volume` AS SIGNED) AS volume\n    FROM `marketdb`.`index_data`\n)\nSELECT\n    trade_date,\n    index_name,\n    open_price,\n    high_price,\n    low_price,\n    close_price,\n    adj_close_price,\n    volume\nFROM source\nWHERE close_price IS NOT NULL", "relation_name": "`marketdb`.`stg_global_index`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T20:46:25.322665Z", "completed_at": "2025-10-26T20:46:25.326688Z"}, {"name": "execute", "started_at": "2025-10-26T20:46:25.327940Z", "completed_at": "2025-10-26T20:46:25.409810Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09150290489196777, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.global_market_dbt.int_market_metrics", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT\n        index_name,\n        trade_date,\n        close_price,\n        LAG(close_price) OVER (PARTITION BY index_name ORDER BY trade_date) AS prev_close\n    FROM `marketdb`.`stg_global_index`\n)\n\nSELECT\n    index_name,\n    trade_date,\n    close_price,\n    (close_price - prev_close) / prev_close AS daily_return,\n    LOG(close_price / prev_close) AS log_return,\n    AVG(close_price) OVER (\n        PARTITION BY index_name \n        ORDER BY trade_date \n        ROWS BETWEEN 7 PRECEDING AND CURRENT ROW\n    ) AS moving_avg,\n    STDDEV_SAMP(close_price) OVER (\n        PARTITION BY index_name \n        ORDER BY trade_date \n        ROWS BETWEEN 7 PRECEDING AND CURRENT ROW\n    ) AS rolling_volatility\nFROM base\nWHERE prev_close IS NOT NULL", "relation_name": "`marketdb`.`int_market_metrics`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T20:46:25.419935Z", "completed_at": "2025-10-26T20:46:25.423508Z"}, {"name": "execute", "started_at": "2025-10-26T20:46:25.424858Z", "completed_at": "2025-10-26T20:46:34.913187Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 9.497342586517334, "adapter_response": {"_message": "SUCCESS 110239", "code": "SUCCESS", "rows_affected": 110239}, "message": "SUCCESS 110239", "failures": null, "unique_id": "model.global_market_dbt.fct_market_summary", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT\n        index_name,\n        trade_date,\n        daily_return,\n        close_price\n    FROM `marketdb`.`int_market_metrics`\n)\n\nSELECT\n    index_name,\n    trade_date,\n    ROUND(AVG(daily_return) OVER (\n        PARTITION BY index_name\n        ORDER BY trade_date\n        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW\n    ), 6) AS avg_return,\n    ROUND(STDDEV_SAMP(daily_return) OVER (\n        PARTITION BY index_name\n        ORDER BY trade_date\n        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW\n    ), 6) AS volatility,\n    MAX(close_price) OVER (\n        PARTITION BY index_name\n        ORDER BY trade_date\n        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW\n    ) AS max_price,\n    MIN(close_price) OVER (\n        PARTITION BY index_name\n        ORDER BY trade_date\n        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW\n    ) AS min_price\nFROM base\nORDER BY index_name, trade_date", "relation_name": "`marketdb`.`fct_market_summary`"}], "elapsed_time": 10.052384614944458, "args": {"strict_mode": false, "select": [], "vars": {}, "version_check": true, "macro_debugging": false, "printer_width": 80, "defer": false, "log_format": "default", "indirect_selection": "eager", "profiles_dir": "/workspaces/Global-Market-Project/dbt", "log_path": "/workspaces/Global-Market-Project/dbt/logs", "show_resource_report": false, "favor_state": false, "project_dir": "/workspaces/Global-Market-Project/dbt", "log_file_max_bytes": 10485760, "cache_selected_only": false, "log_format_file": "debug", "invocation_command": "dbt run", "write_json": true, "enable_legacy_logger": false, "which": "run", "exclude": [], "quiet": false, "introspect": true, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "log_level": "info", "print": true, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "log_level_file": "debug", "use_colors_file": true, "static_parser": true, "use_colors": true, "partial_parse": true}}